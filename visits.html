<html>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NDG392MCRE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-NDG392MCRE');
</script>  
<style>
@import url('https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap');
/* Center child elements */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Montserrat', sans-serif;
}
body,
.website-counter {
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  background-color: #648FFF;
  color: white;
}
body {
  height: 100vh;
}
/* Styles for website counter container */
.website-counter {
  background-color: #DC267F;
  height: 50px;
  width: 80px;
  color: white;
  border-radius: 30px;
  font-weight: 700;
  font-size: 25px;
  margin-top: 10px;
}
</style>
  <head>
    <title>Website Counter</title>
<!--     <script defer src="index.js"></script>
    <link rel="stylesheet" href="styles.css" /> -->
  </head>
  <body>
    <div>Website Visit Count:</div>
    <div class="website-counter"></div>
  </body>

<!-- Load js for require funciton -->
<script src="https://requirejs.org/docs/release/2.3.5/minified/require.js"></script>
<script>


// trying to include headers to allow CORS
// const express = require(['require', 'express']);
// const app = express();

// const cors = require('cors');

// app.use(cors({
//   "origin": "https://unique-visitors.pebbleparadisepeople.workers.dev/",
//   "methods": "GET,HEAD,PUT,PATCH,POST,DELETE",
//   "preflightContinue": false,
//   "optionsSuccessStatus": 204
// }))

// data collection here
  
// Your API routes and logic here...
  var counterContainer = document.querySelector(".website-counter");

  // Replace 'https://unique-visitors.pebbleparadisepeople.workers.dev/' with the URL you want to fetch data from
  var url = 'https://unique-visitors.pebbleparadisepeople.workers.dev/';
  //trying data collection
  document.addEventListener("DOMContentLoaded", function(){
    const info = {   browserLang: navigator.browserLanguage,
                     language: navigator.language,
                     platform: navigator.platform,
                     connectionSpeed: navigator.connectionSpeed,
                     userAgent: navigator.UserAgent,
                     webdriver: navigator.webdriver,
                     geolocation: navigator.geolocation
                  } 
    const exists = getFingerprint(info);
    if(!exists){
      fetch(url, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(info)                   
        }
      } //end eventListener
  }//end if

  //Check if fingerprint/unique user exists
  
                            
  // Fetch the website content
  fetch(url)
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.text();
    })
    .then(data => {
      // Display the content on the page
      counterContainer.innerHTML = data; // Assuming the response is a string
    })
    .catch(error => {
      console.error('Fetch error:', error);
      counterContainer.innerHTML = 'Error loading data'; // Display an error message
    });

</script>
</html>
